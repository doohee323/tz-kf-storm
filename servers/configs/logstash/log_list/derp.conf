input {
  file {
  	  type => "json"
      path => "/home/vagrant/data/*.log"
      start_position => "beginning"
  }
}
filter{
	json{
	    source => "message"
	}
	ruby {
		code => "event['timestamp'] = Time.at(event['timestamp']).strftime('%Y-%m-%dT%H:%M:%S') + '.' + event['microsecs'].to_s[1,3] + 'Z'"
  	}
}
output {
	kafka {
    	codec => plain {
       		format => "%{message}"
		}
		topic_id => "logs"
  }
  stdout { codec => rubydebug }
}

